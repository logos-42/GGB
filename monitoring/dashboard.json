{
  "dashboard": {
    "name": "GGB去中心化算力系统监控",
    "description": "监控Cloudflare Workers上的去中心化算力系统",
    "refresh_interval": 30,
    "widgets": [
      {
        "type": "timeseries",
        "title": "请求吞吐量",
        "metrics": [
          {
            "name": "requests.total",
            "aggregation": "sum",
            "group_by": ["status_code"]
          }
        ],
        "width": 12,
        "height": 6
      },
      {
        "type": "timeseries",
        "title": "响应时间",
        "metrics": [
          {
            "name": "requests.duration",
            "aggregation": "avg",
            "group_by": ["endpoint"]
          },
          {
            "name": "requests.duration",
            "aggregation": "p95",
            "group_by": ["endpoint"]
          },
          {
            "name": "requests.duration",
            "aggregation": "p99",
            "group_by": ["endpoint"]
          }
        ],
        "width": 12,
        "height": 6
      },
      {
        "type": "stat",
        "title": "活跃节点数",
        "metric": {
          "name": "nodes.active",
          "aggregation": "latest"
        },
        "width": 4,
        "height": 4
      },
      {
        "type": "stat",
        "title": "总任务数",
        "metric": {
          "name": "tasks.total",
          "aggregation": "sum"
        },
        "width": 4,
        "height": 4
      },
      {
        "type": "stat",
        "title": "成功率",
        "metric": {
          "name": "requests.success_rate",
          "aggregation": "avg"
        },
        "width": 4,
        "height": 4
      },
      {
        "type": "timeseries",
        "title": "算法性能",
        "metrics": [
          {
            "name": "algorithms.execution_time",
            "aggregation": "avg",
            "group_by": ["algorithm_type"]
          }
        ],
        "width": 8,
        "height": 6
      },
      {
        "type": "timeseries",
        "title": "ZK证明验证",
        "metrics": [
          {
            "name": "zk_proof.verification_time",
            "aggregation": "avg"
          },
          {
            "name": "zk_proof.success_rate",
            "aggregation": "avg"
          }
        ],
        "width": 4,
        "height": 6
      },
      {
        "type": "table",
        "title": "端点性能排行",
        "metrics": [
          {
            "name": "requests.duration",
            "aggregation": "avg",
            "group_by": ["endpoint"]
          },
          {
            "name": "requests.count",
            "aggregation": "sum",
            "group_by": ["endpoint"]
          }
        ],
        "columns": ["endpoint", "avg_duration", "request_count"],
        "width": 12,
        "height": 8
      },
      {
        "type": "gauge",
        "title": "CPU使用率",
        "metric": {
          "name": "system.cpu_usage",
          "aggregation": "avg"
        },
        "thresholds": {
          "warning": 70,
          "critical": 90
        },
        "width": 4,
        "height": 4
      },
      {
        "type": "gauge",
        "title": "内存使用率",
        "metric": {
          "name": "system.memory_usage",
          "aggregation": "avg"
        },
        "thresholds": {
          "warning": 80,
          "critical": 95
        },
        "width": 4,
        "height": 4
      },
      {
        "type": "gauge",
        "title": "错误率",
        "metric": {
          "name": "requests.error_rate",
          "aggregation": "avg"
        },
        "thresholds": {
          "warning": 1,
          "critical": 5
        },
        "width": 4,
        "height": 4
      }
    ],
    "alerts": [
      {
        "name": "高错误率告警",
        "condition": "requests.error_rate > 5",
        "duration": "5m",
        "severity": "critical",
        "channels": ["email", "slack"]
      },
      {
        "name": "高响应时间告警",
        "condition": "requests.duration.p95 > 1000",
        "duration": "5m",
        "severity": "warning",
        "channels": ["slack"]
      },
      {
        "name": "低节点活跃度告警",
        "condition": "nodes.active < 10",
        "duration": "10m",
        "severity": "warning",
        "channels": ["slack"]
      },
      {
        "name": "ZK证明验证失败告警",
        "condition": "zk_proof.success_rate < 95",
        "duration": "5m",
        "severity": "critical",
        "channels": ["email", "slack", "pagerduty"]
      }
    ]
  },
  "metrics": {
    "requests": {
      "total": "总请求数",
      "duration": "请求耗时（毫秒）",
      "success_rate": "请求成功率（百分比）",
      "error_rate": "请求错误率（百分比）",
      "count": "请求计数"
    },
    "nodes": {
      "active": "活跃节点数",
      "total": "总节点数",
      "registration_rate": "节点注册速率",
      "heartbeat_success_rate": "心跳成功率"
    },
    "tasks": {
      "total": "总任务数",
      "completed": "已完成任务数",
      "failed": "失败任务数",
      "completion_rate": "任务完成率",
      "avg_completion_time": "平均完成时间"
    },
    "algorithms": {
      "execution_time": "算法执行时间（毫秒）",
      "allocation_count": "分配次数",
      "success_rate": "算法成功率"
    },
    "zk_proof": {
      "verification_time": "证明验证时间（毫秒）",
      "generation_time": "证明生成时间（毫秒）",
      "success_rate": "验证成功率",
      "batch_size": "批量验证大小"
    },
    "system": {
      "cpu_usage": "CPU使用率（百分比）",
      "memory_usage": "内存使用率（百分比）",
      "wasm_module_size": "WASM模块大小（字节）",
      "uptime": "运行时间（秒）"
    }
  },
  "exporters": [
    {
      "type": "cloudflare_workers",
      "config": {
        "account_id": "${CF_ACCOUNT_ID}",
        "worker_name": "ggb-edge-server",
        "metrics": ["requests", "duration", "errors"]
      }
    },
    {
      "type": "custom",
      "config": {
        "endpoint": "/api/metrics",
        "format": "prometheus",
        "interval": 30
      }
    }
  ],
  "integrations": {
    "slack": {
      "webhook_url": "${SLACK_WEBHOOK_URL}",
      "channel": "#ggb-alerts",
      "username": "GGB监控机器人"
    },
    "email": {
      "smtp_server": "${SMTP_SERVER}",
      "from": "alerts@ggb-system.com",
      "to": ["devops@ggb-system.com", "engineering@ggb-system.com"]
    },
    "pagerduty": {
      "integration_key": "${PAGERDUTY_INTEGRATION_KEY}",
      "service_name": "GGB生产系统"
    }
  }
}
