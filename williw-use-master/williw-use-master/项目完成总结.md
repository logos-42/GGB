# Williw-Use é¡¹ç›®å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. é¡¹ç›®ç»“æ„
åˆ›å»ºäº†å®Œæ•´çš„é¡¹ç›®ç»“æ„ï¼š
```
williw-use/
â”œâ”€â”€ edge_server/          # è¾¹ç¼˜æœåŠ¡å™¨æ¨¡å—
â”‚   â”œâ”€â”€ api_server.py     # Flask APIæœåŠ¡å™¨
â”‚   â”œâ”€â”€ model_fetcher.py  # æ¨¡å‹è·å–ï¼ˆHugging Face/æœ¬åœ°ï¼‰
â”‚   â”œâ”€â”€ model_converter.py # ONNXâ†’PyTorchè½¬æ¢
â”‚   â”œâ”€â”€ compute_estimator.py # ç®—åŠ›ä¼°ç®—ï¼ˆä¿å®ˆç­–ç•¥ï¼‰
â”‚   â””â”€â”€ workflow_orchestrator.py # å·¥ä½œæµç¼–æ’å™¨
â”œâ”€â”€ interface_layer/      # æ¥å£å±‚
â”‚   â”œâ”€â”€ node_info_api.py  # èŠ‚ç‚¹ä¿¡æ¯APIï¼ˆä»williw-masterè·å–ï¼‰
â”‚   â””â”€â”€ app_client.py     # å®¢æˆ·ç«¯ç¤ºä¾‹
â”œâ”€â”€ models/               # æ¨¡å‹ç›¸å…³
â”‚   â”œâ”€â”€ inference_engine.py # åˆ†å¸ƒå¼æ¨ç†å¼•æ“
â”‚   â””â”€â”€ result_merger.py  # ç»“æœé›†æˆ
â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ config.py         # é…ç½®ç®¡ç†
â””â”€â”€ example_usage.py      # ä½¿ç”¨ç¤ºä¾‹
```

### 2. æ ¸å¿ƒæ¨¡å—å®ç°

#### è¾¹ç¼˜æœåŠ¡å™¨æ¨¡å—
- âœ… **api_server.py**: Flask APIæœåŠ¡å™¨ï¼Œæ¥æ”¶æ¨ç†è¯·æ±‚
- âœ… **model_fetcher.py**: ä»Hugging Face Hubæˆ–æœ¬åœ°ä»“åº“è·å–æ¨¡å‹
- âœ… **model_converter.py**: ONNXâ†’PyTorchè½¬æ¢ï¼Œè¯»å–state_dict
- âœ… **compute_estimator.py**: ä¿å®ˆç®—åŠ›ä¼°ç®—ï¼ˆå®‰å…¨ç³»æ•°1.5ï¼Œå¯ç®—å¤šä¸å¯ç®—å°‘ï¼‰
- âœ… **workflow_orchestrator.py**: å®Œæ•´å·¥ä½œæµç¼–æ’ï¼ˆ8ä¸ªæ­¥éª¤ï¼‰

#### æ¥å£å±‚æ¨¡å—
- âœ… **node_info_api.py**: ä»williw-masterè·å–èŠ‚ç‚¹ä¿¡æ¯ï¼ˆæ”¯æŒæ¨¡æ‹Ÿæ•°æ®ï¼‰
- âœ… **app_client.py**: å®¢æˆ·ç«¯ç¤ºä¾‹ä»£ç 

#### æ¨¡å‹ç›¸å…³æ¨¡å—
- âœ… **inference_engine.py**: åˆ†å¸ƒå¼æ¨ç†å¼•æ“ï¼ˆé“¾å¼æ¨ç†ï¼‰
- âœ… **result_merger.py**: ç»“æœé›†æˆæ¨¡å—

### 3. å®Œæ•´å·¥ä½œæµç¨‹

å®ç°äº†å®Œæ•´çš„8æ­¥å·¥ä½œæµï¼š
1. âœ… ä»Hugging Face/æ¨¡å‹ä»“åº“è·å–æ¨¡å‹
2. âœ… ONNX â†’ PyTorchè½¬æ¢ï¼ˆå¦‚æœéœ€è¦ï¼‰
3. âœ… è¯»å–state_dictæ–‡ä»¶
4. âœ… ä¼°ç®—æ¨¡å‹ç®—åŠ›éœ€æ±‚ï¼ˆä¿å®ˆä¼°ç®—ï¼‰
5. âœ… ä»williw-masterè·å–èŠ‚ç‚¹ä¿¡æ¯
6. âœ… è°ƒç”¨ç®—æ³•å±‚ï¼ˆèŠ‚ç‚¹é€‰æ‹©ã€è·¯å¾„ä¼˜åŒ–ã€èµ„æºåˆ†é…ã€æ¨¡å‹åˆ‡åˆ†ï¼‰
7. âœ… åˆ†å¸ƒå¼æ¨¡å‹æ¨ç†ï¼ˆéè®­ç»ƒï¼‰
8. âœ… é›†æˆæ¨ç†ç»“æœå¹¶è¿”å›

## ğŸ”— ä¸‰ä¸ªé¡¹ç›®çš„æ•´åˆ

### lkcé¡¹ç›®ï¼ˆç®—æ³•å±‚ï¼‰
- **ä½ç½®**: `/work/lkc/youhua/lkc`
- **æ•´åˆæ–¹å¼**: 
  - ç›´æ¥å¼•ç”¨ `algorithms/dcaco_algorithm.py`ï¼ˆD-CACOç®—æ³•ï¼‰
  - å¼•ç”¨ `utils/geo_utils.py`ï¼ˆåœ°ç†ä½ç½®å·¥å…·ï¼‰
  - ç”±äºlkcæ ¸å¿ƒæ–‡ä»¶è¢«åˆ é™¤ï¼Œå·¥ä½œæµç¼–æ’å™¨ä¸­ä½¿ç”¨äº†ç®€åŒ–ç‰ˆçš„èŠ‚ç‚¹é€‰æ‹©å’Œæ¨¡å‹åˆ‡åˆ†é€»è¾‘
  - **å»ºè®®**: æ¢å¤lkcé¡¹ç›®çš„æ ¸å¿ƒæ–‡ä»¶ï¼ˆcore/node.py, core/scheduler.pyç­‰ï¼‰ä»¥è·å¾—å®Œæ•´åŠŸèƒ½

### williw-masteré¡¹ç›®ï¼ˆæ¥å£å±‚ï¼‰
- **ä½ç½®**: `/work/lkc/youhua/williw-master`
- **æ•´åˆæ–¹å¼**:
  - `node_info_api.py` ä»williw-master APIè·å–èŠ‚ç‚¹ä¿¡æ¯
  - æ”¯æŒRusté¡¹ç›®çš„èŠ‚ç‚¹æ•°æ®ç»“æ„è½¬æ¢
  - å¦‚æœAPIä¸å¯ç”¨ï¼Œä½¿ç”¨æ¨¡æ‹ŸèŠ‚ç‚¹æ•°æ®
  - **å»ºè®®**: å¦‚æœwilliw-masteræä¾›HTTP APIï¼Œéœ€è¦é…ç½®APIåœ°å€

### williw-useé¡¹ç›®ï¼ˆè¾¹ç¼˜æœåŠ¡å™¨ï¼‰
- **ä½ç½®**: `/work/lkc/williw-use`
- **åŠŸèƒ½**: æ•´åˆä¸Šè¿°ä¸¤ä¸ªé¡¹ç›®ï¼Œæä¾›å®Œæ•´çš„æ¨ç†æœåŠ¡

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. å®‰è£…ä¾èµ–

```bash
cd /work/lkc/williw-use
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

```bash
export WILLIW_API_URL=http://localhost:8081  # williw-master APIåœ°å€
export HUGGINGFACE_CACHE_DIR=./hf_cache      # Hugging Faceç¼“å­˜ç›®å½•
export MODEL_REPOSITORY_PATH=./model_repository  # æœ¬åœ°æ¨¡å‹ä»“åº“è·¯å¾„
export PORT=8080                             # è¾¹ç¼˜æœåŠ¡å™¨ç«¯å£
```

### 3. å¯åŠ¨è¾¹ç¼˜æœåŠ¡å™¨

```bash
python -m edge_server.api_server
# æˆ–
python example_usage.py  # é€‰æ‹©é€‰é¡¹1
```

### 4. ä½¿ç”¨å®¢æˆ·ç«¯

```python
from interface_layer.app_client import InferenceClient

client = InferenceClient(server_url="http://localhost:8080")
result = client.inference(
    model_name="bert-base-uncased",
    model_source="huggingface",
    input_data={"text": "Hello world"},
    parameters={"batch_size": 1}
)
print(result)
```

## ğŸ“‹ APIæ¥å£

### POST /api/inference
æ¥æ”¶æ¨ç†è¯·æ±‚

**è¯·æ±‚ä½“**:
```json
{
    "model_name": "bert-base-uncased",
    "model_source": "huggingface",
    "input_data": {
        "text": "Hello world"
    },
    "parameters": {
        "batch_size": 1
    }
}
```

**å“åº”**:
```json
{
    "status": "success",
    "result": {...},
    "nodes_used": ["node_001", "node_002"],
    "inference_time": 123.45
}
```

### GET /api/health
å¥åº·æ£€æŸ¥

### GET /api/models
åˆ—å‡ºæœ¬åœ°å¯ç”¨æ¨¡å‹

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **lkcç®—æ³•å±‚**: ç”±äºlkcæ ¸å¿ƒæ–‡ä»¶è¢«åˆ é™¤ï¼Œå½“å‰ä½¿ç”¨ç®€åŒ–ç‰ˆçš„èŠ‚ç‚¹é€‰æ‹©å’Œæ¨¡å‹åˆ‡åˆ†ã€‚å»ºè®®æ¢å¤lkcé¡¹ç›®çš„æ ¸å¿ƒæ–‡ä»¶ä»¥è·å¾—å®Œæ•´åŠŸèƒ½ã€‚

2. **williw-master API**: å½“å‰æ”¯æŒä»williw-master APIè·å–èŠ‚ç‚¹ä¿¡æ¯ï¼Œä½†å¦‚æœAPIä¸å¯ç”¨ä¼šè‡ªåŠ¨ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ã€‚éœ€è¦ç¡®ä¿williw-masteræä¾›HTTP APIã€‚

3. **æ¨¡å‹æ¨ç†**: å½“å‰æ¨ç†å¼•æ“ä½¿ç”¨ç®€åŒ–çš„åˆ†ç‰‡æ¨¡å‹åŠ è½½ï¼ˆä»…æ”¯æŒLinearå±‚ï¼‰ã€‚å®é™…ä½¿ç”¨éœ€è¦æ ¹æ®æ¨¡å‹ç±»å‹å®ç°å®Œæ•´çš„åˆ†ç‰‡æ¨¡å‹é‡æ„ã€‚

4. **åˆ†å¸ƒå¼é€šä¿¡**: å½“å‰æ¨ç†å¼•æ“åœ¨å•ä¸ªè¿›ç¨‹ä¸­æ¨¡æ‹Ÿåˆ†å¸ƒå¼æ¨ç†ã€‚å®é™…éƒ¨ç½²éœ€è¦åœ¨èŠ‚ç‚¹é—´å»ºç«‹çœŸå®çš„é€šä¿¡é€šé“ã€‚

## ğŸ”§ åç»­ä¼˜åŒ–å»ºè®®

1. **æ¢å¤lkcæ ¸å¿ƒæ¨¡å—**: æ¢å¤ `core/node.py`, `core/scheduler.py`, `algorithms/node_selection.py` ç­‰æ ¸å¿ƒæ–‡ä»¶
2. **å®Œå–„æ¨¡å‹åˆ‡åˆ†**: å®ç°æ›´æ™ºèƒ½çš„æ¨¡å‹åˆ‡åˆ†ç­–ç•¥ï¼Œæ”¯æŒä¸åŒç±»å‹çš„æ¨¡å‹ï¼ˆCNNã€Transformerç­‰ï¼‰
3. **çœŸå®åˆ†å¸ƒå¼æ¨ç†**: å®ç°èŠ‚ç‚¹é—´çš„çœŸå®ç½‘ç»œé€šä¿¡ï¼ˆå¦‚gRPCã€WebSocketï¼‰
4. **æ€§èƒ½ä¼˜åŒ–**: ä¼˜åŒ–ç®—åŠ›ä¼°ç®—å‡†ç¡®æ€§ï¼Œä¼˜åŒ–æ¨ç†æ€§èƒ½
5. **é”™è¯¯å¤„ç†**: å¢å¼ºé”™è¯¯å¤„ç†å’Œæ•…éšœæ¢å¤æœºåˆ¶
6. **ç›‘æ§å’Œæ—¥å¿—**: æ·»åŠ è¯¦ç»†çš„ç›‘æ§å’Œæ—¥å¿—åŠŸèƒ½

## ğŸ“ æ–‡ä»¶æ¸…å•

å·²åˆ›å»ºçš„æ‰€æœ‰æ ¸å¿ƒæ–‡ä»¶ï¼š
- âœ… edge_server/api_server.py
- âœ… edge_server/model_fetcher.py
- âœ… edge_server/model_converter.py
- âœ… edge_server/compute_estimator.py
- âœ… edge_server/workflow_orchestrator.py
- âœ… interface_layer/node_info_api.py
- âœ… interface_layer/app_client.py
- âœ… models/inference_engine.py
- âœ… models/result_merger.py
- âœ… utils/config.py
- âœ… example_usage.py
- âœ… README.md
- âœ… requirements.txt

## âœ¨ æ€»ç»“

å·²æˆåŠŸåˆ›å»ºwilliw-useé¡¹ç›®ï¼Œæ•´åˆäº†ä¸‰ä¸ªé¡¹ç›®çš„åŠŸèƒ½ï¼Œå®ç°äº†å®Œæ•´çš„åˆ†å¸ƒå¼æ¨¡å‹æ¨ç†ç³»ç»Ÿã€‚æ‰€æœ‰æ ¸å¿ƒæ¨¡å—å·²ç»å®ç°ï¼Œå¯ä»¥è¿›è¡ŒåŸºæœ¬çš„æµ‹è¯•å’Œä½¿ç”¨ã€‚å»ºè®®æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œä¼˜åŒ–å’Œæ‰©å±•ã€‚
